. Project Overview
Name: Eski kiken ena (Mauritius)
Type: Peer-to-Peer Rental Marketplace for Power Tools & Equipment.
Hosting Strategy: Vercel Hobby Tier (App) + Vercel Postgres (Database) + GCP Free Tier (Storage).
Mission: To answer the common Mauritian question "Eski kiken ena enn drill?"
Target Audience: Mauritian homeowners and construction workers.
Key Constraint: Mobile-first, optimized for 3G/4G networks, utilizing serverless architecture.
2. Technology Stack
Framework: SvelteKit (TypeScript)
Adapter: @sveltejs/adapter-vercel (Serverless)
Database: Vercel Postgres (Powered by Neon)
ORM: Drizzle ORM
Auth: Lucia Auth (v3, Drizzle Adapter)
Styling: Tailwind CSS
Storage: Google Cloud Storage (GCP) - us-east1 or us-central1 (Free Tier eligible).
Icons: Lucide-Svelte
3. Directory Structure
code
Text
src/
├── lib/
│   ├── components/
│   │   ├── ui/               # Reusable primitives
│   │   ├── listing/          # ListingCard (Lazy loaded images)
│   │   ├── navigation/       # Navbar, MobileMenu (Sticky bottom)
│   ├── server/
│   │   ├── db/
│   │   │   ├── index.ts      # DB Connection (SSL enabled)
│   │   │   └── schema.ts     # Table Definitions
│   │   ├── auth.ts           # Lucia Setup
│   │   ├── storage.ts        # GCP Storage Logic
│   │   └── actions/          # Reusable DB queries
│   └── utils/                # Formatters
├── routes/
│   ├── +layout.svelte
│   ├── +page.svelte          # Landing Page
│   ├── listings/
│   │   ├── new/              # Protected
│   │   └── [id]/             # Public
│   ├── dashboard/            # Protected
│   └── api/                  # API routes
├── drizzle/                  # SQL Migrations
├── drizzle.config.ts
└── svelte.config.js
4. Database Schema (Drizzle)
File: src/lib/server/db/schema.ts
Enums
District: PORT_LOUIS, PAMPLEMOUSSES, RIVIERE_DU_REMPART, FLACQ, GRAND_PORT, SAVANNE, PLAINES_WILHEMS, MOKA, BLACK_RIVER, RODRIGUES
Role: USER, ADMIN
BookingStatus: PENDING, CONFIRMED, PAID, ACTIVE, COMPLETED, CANCELLED
Tables
users: id (UUID), email, hashed_password, first_name, last_name, phone, role, kyc_status.
sessions: id (Text), user_id (UUID), expires_at (Date).
listings: id (UUID), owner_id (UUID), title, description, price_per_day (Decimal), district (Enum), images (JSONB), is_active (Bool).
bookings: id (UUID), listing_id, renter_id, start_date, end_date, total_price, status.
5. Implementation Details (Vercel Specific)
A. Environment Configuration (.env)
Required variables for Vercel Project Settings:
code
Env
# Database (Auto-generated by Vercel Integration, but needed locally)
POSTGRES_URL="postgres://default:pass@ep-xyz.us-east-1.aws.neon.tech:5432/verceldb?sslmode=require"

# GCP Storage (Add manually to Vercel env)
GCP_PROJECT_ID="your-project-id"
GCP_CLIENT_EMAIL="service-account@..."
GCP_PRIVATE_KEY="-----BEGIN PRIVATE KEY..."
B. Database Connection (db/index.ts)
Critical: Vercel Postgres requires SSL.
code
TypeScript
import { drizzle } from 'drizzle-orm/postgres-js';
import postgres from 'postgres';
import { env } from '$env/dynamic/private';
import * as schema from './schema';

const client = postgres(env.POSTGRES_URL, { 
    prepare: false,
    ssl: 'require' // REQUIRED for Vercel
});

export const db = drizzle(client, { schema });
C. Svelte Configuration (svelte.config.js)
Must use the Vercel adapter.
code
JavaScript
import adapter from '@sveltejs/adapter-vercel';
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

/** @type {import('@sveltejs/kit').Config} */
const config = {
    preprocess: vitePreprocess(),
    kit: {
        adapter: adapter()
    }
};
export default config;
D. Image Storage (storage.ts)
Bucket: eski-kiken-ena-uploads (Created in GCP Console).
Permission: Make the tools/ folder publicly readable via GCP Console bucket permissions.
Logic: Upload file -> Return https://storage.googleapis.com/BUCKET_NAME/tools/FILENAME.
6. Development Workflow for AI Agent
Initialize:
Create SvelteKit project.
Run: npm install -D @sveltejs/adapter-vercel.
Remove: npm uninstall @sveltejs/adapter-node.
Install: drizzle-orm, postgres, lucia, @lucia-auth/adapter-drizzle.
Database Setup:
Define schema.ts.
Set up drizzle.config.ts.
Migration Instruction: "Run npx drizzle-kit push to sync the local schema directly to the Vercel Postgres database (using the connection string from .env)."
Authentication:
Implement hooks.server.ts to read session cookies.
Create routes/login/+page.server.ts (Form Actions).
UI Construction:
Build ListingCard.svelte with aspect-video to prevent layout shifts on slow mobile connections.
Use Tailwind grid for the main feed.
7. Migration Commands
To apply changes to the Vercel database from your local machine:
code
Bash
# In terminal
export POSTGRES_URL="your_vercel_connection_string"
npx drizzle-kit migrate
8. Specific Visuals
Header: "Eski kiken ena" (Text logo, bold).
Colors: Ocean Blue (#0077b6) and Sunset Orange (#fb8500).
Empty State: If no tools found, show text: "Pena nanye dan sa l'endroit la. Check enn lot district?" (Creole: Nothing in this area. Check another district?)